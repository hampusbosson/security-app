generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id            Int            @id @default(autoincrement())
  githubId      Int            @unique
  username      String
  email         String?
  avatarUrl     String?
  createdAt     DateTime       @default(now())
  installations Installation[]
}

model Installation {
  id             Int          @id @default(autoincrement())
  installationId Int          @unique
  accountLogin   String?
  accountType    String?
  createdAt      DateTime     @default(now())
  userId         Int
  user           User         @relation(fields: [userId], references: [id])
  repositories   Repository[]
}

model Repository {
  id            Int      @id @default(autoincrement())
  githubRepoId  Int      @unique
  name          String
  fullName      String
  private       Boolean
  defaultBranch String?
  createdAt     DateTime @default(now())
  lastCommit              String?
  openPrCount             Int?
  openIssueCount          Int?
  primaryLanguage         String?
  branchProtectionEnabled Boolean? @default(false)
  dependabotAlertCount    Int?     @default(0)
  secretScanningEnabled   Boolean? @default(false)
  securityScore  Int?
  lastScan       DateTime?
  installationId Int
  installation   Installation @relation(fields: [installationId], references: [id])
}
